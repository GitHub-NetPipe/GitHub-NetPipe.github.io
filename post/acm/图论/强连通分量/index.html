<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">

  <title>强连通分量 &#8211; NetPipe&#39;s Blog</title>

  
  <meta name="description" content="简介 ¶强连通 ¶在有向图 $G$ 中，如果同时存在 $u→v$ 和 $v→u$ 的路径，那么称 $u$ 和 $v$ 强连通.">
  
  <meta name="author" content="NetPipe">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link href="../../../../index.xml" rel="alternate" type="application/rss+xml" title="NetPipe&#39;s Blog" />
  <link rel="shortcut icon" type="image/x-icon" href="../../../../images/freeze.png" />

  
    <style>@font-face {
  font-family: 'Fantasque Sans Mono';
  src: url("/fonts/FantasqueSansMono-Regular.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: normal;
  font-weight: bold;
  src: url("/fonts/FantasqueSansMono-Bold.woff2") format("woff2"); }

@font-face {
  font-family: 'Fantasque Sans Mono';
  font-style: italic;
  src: url("/fonts/FantasqueSansMono-Italic.woff2") format("woff2"); }

@font-face {
  font-family: 'Lazy';
  src: url("/fonts/lazy.ttf") format("truetype"); }

@font-face {
  font-family: 'Material Icons';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Outlined';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Outlined.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Round';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Round.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Sharp';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Sharp.woff2") format("woff2"); }

/* fallback */
@font-face {
  font-family: 'Material Icons Two Tone';
  font-style: normal;
  font-weight: 400;
  src: url("/fonts/Material Icons Two Tone.woff2") format("woff2"); }

.material-icons {
  font-family: 'Material Icons';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-outlined {
  font-family: 'Material Icons Outlined';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-round {
  font-family: 'Material Icons Round';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-sharp {
  font-family: 'Material Icons Sharp';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

.material-icons-two-tone {
  font-family: 'Material Icons Two Tone';
  font-weight: normal;
  font-style: normal;
  font-size: 24px;
  line-height: 1;
  letter-spacing: normal;
  text-transform: none;
  display: inline-block;
  white-space: nowrap;
  word-wrap: normal;
  direction: ltr;
  -webkit-font-feature-settings: 'liga';
  -webkit-font-smoothing: antialiased; }

body,
code,
input {
  font-family: 'Fantasque Sans Mono', sans-serif;
  -webkit-font-smoothing: antialiased; }
  body article h1, body article h2, body article h3, body article h4, body article h5, body article h6, body .posts h1, body .posts h2, body .posts h3, body .posts h4, body .posts h5, body .posts h6,
  code article h1,
  code article h2,
  code article h3,
  code article h4,
  code article h5,
  code article h6,
  code .posts h1,
  code .posts h2,
  code .posts h3,
  code .posts h4,
  code .posts h5,
  code .posts h6,
  input article h1,
  input article h2,
  input article h3,
  input article h4,
  input article h5,
  input article h6,
  input .posts h1,
  input .posts h2,
  input .posts h3,
  input .posts h4,
  input .posts h5,
  input .posts h6 {
    font-weight: normal; }

strong {
  font-weight: normal;
  text-shadow: 0 0; }

* {
  margin: 0;
  padding: 0;
  user-select: none;
  -moz-user-select: none;
  -webkit-user-select: none;
  --aside-width: 18rem;
  --box-shadow: 0 1px 6px 0 rgba(0, 0, 0, 0.1);
  --box-shadow-hover: 0 2px 16px 0 rgba(0, 0, 0, 0.1); }

* {
  --color: black;
  --border: 1px solid #dee0e2;
  --border-color: #dee0e2;
  --border-radius: 0.25rem;
  --link-color: #4588be;
  --category-color: rgba(173, 216, 230, .7);
  --background-color: white;
  --hover-color: #f7f7f7; }
  * body {
    background-color: #f6f6f6; }

::selection {
  background-color: #CCE2FF;
  color: rgba(0, 0, 0, 0.87); }

::-webkit-scrollbar {
  width: 7px;
  height: 7px; }

::-webkit-scrollbar-thumb {
  border-radius: 10px;
  background: #dddddd; }
  ::-webkit-scrollbar-thumb:hover {
    background: #acacac; }

::-webkit-scrollbar-track {
  border-radius: 10px;
  background: #f0f0f0; }

a {
  text-decoration: none;
  color: #4794d3; }

a:focus, a:hover {
  outline: none;
  text-decoration: underline; }

a.alternate:focus,
a.alternate:hover,
a.alternate:focus > *,
a.alternate:hover > * {
  text-decoration: none;
  background: var(--hover-color); }

small {
  font-size: 70%; }

ol, ul {
  margin: .5rem 0;
  padding-left: 2rem;
  word-break: break-word; }
  ol > li, ul > li {
    margin: .5rem 0; }

ul > li {
  list-style: circle; }

.result {
  width: 100%; }
  .result :first-child .post {
    margin-top: 0; }
  .result :last-child .post {
    margin-bottom: 0; }

.flex {
  display: flex; }

.flex-auto {
  flex: 1 1 auto; }

.flex-even {
  flex: 1 1; }

.flex-wrap {
  flex-wrap: wrap; }

.justify-start {
  justify-content: flex-start; }

.justify-end {
  justify-content: flex-end; }

.justify-center {
  justify-content: center; }

.justify-between {
  justify-content: space-between; }

.align-center {
  align-items: center; }

.mx-auto {
  margin: 0 auto; }

.text-center {
  text-align: center; }

.text-left {
  text-align: left; }

.text-right {
  text-align: right; }

.hidden {
  display: none; }

body {
  max-width: 80rem;
  margin: 0 auto;
  overflow: hidden scroll; }

main {
  display: flex; }

article {
  overflow: hidden;
  will-change: transform; }

div.avatar {
  text-align: center; }
  div.avatar .data-left,
  div.avatar .data-right {
    flex: 0 0 50%;
    display: inline-block;
    width: calc(50% - 1rem); }
  div.avatar .data-left {
    border-right: 1px solid var(--color); }
  div.avatar .social {
    margin-top: 1rem; }
    div.avatar .social .social-box {
      border: var(--border);
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      background-color: var(--background-color);
      color: var(--color);
      margin-top: .5rem;
      padding: .5rem;
      text-align: left;
      font-size: 18px; }
      div.avatar .social .social-box:hover {
        box-shadow: var(--box-shadow-hover); }
      div.avatar .social .social-box a {
        color: var(--color); }
      div.avatar .social .social-box:hover a {
        color: var(--link-color);
        text-decoration: underline; }
      div.avatar .social .social-box img {
        vertical-align: text-bottom;
        width: 20px; }
      div.avatar .social .social-box .search {
        display: inline-block;
        width: calc(100% - 36px); }
        div.avatar .social .social-box .search > input {
          background-color: var(--background-color);
          color: var(--color);
          border: none;
          font-size: 17px;
          outline: none;
          width: 100%; }

div.categories .post-categories {
  font-size: 100%;
  margin: .5rem 0;
  line-height: 1.7rem; }

#TableOfContents > ul {
  padding-left: 0; }
  #TableOfContents > ul li {
    list-style: none; }

.flex-left,
.flex-right {
  flex: 0 0 var(--aside-width); }
  .flex-left div.outer,
  .flex-right div.outer {
    padding: .7rem;
    margin: .3rem;
    width: calc(var(--aside-width) - 2rem);
    height: calc(100% - 2rem);
    overflow: hidden;
    position: fixed; }
    .flex-left div.outer::-webkit-scrollbar-track,
    .flex-right div.outer::-webkit-scrollbar-track {
      margin: .7rem; }
    .flex-left div.outer:hover,
    .flex-right div.outer:hover {
      overflow: auto; }
  .flex-left div.inner,
  .flex-right div.inner {
    border: var(--border);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    background-color: var(--background-color);
    color: var(--color);
    box-sizing: border-box;
    width: calc(var(--aside-width) - 2rem);
    padding: .5rem;
    margin-bottom: 1rem;
    overflow: auto;
    padding: 1rem; }
    .flex-left div.inner:hover,
    .flex-right div.inner:hover {
      box-shadow: var(--box-shadow-hover); }
    .flex-left div.inner h2,
    .flex-right div.inner h2 {
      margin: .5rem 0;
      line-height: 20px; }
      .flex-left div.inner h2 > img,
      .flex-right div.inner h2 > img {
        vertical-align: -2px;
        width: 20px;
        height: 20px;
        margin-right: .5rem; }
    .flex-left div.inner ul,
    .flex-right div.inner ul {
      padding-left: 1rem; }
    .flex-left div.inner > :first-child,
    .flex-right div.inner > :first-child {
      margin-top: 0; }
    .flex-left div.inner > :last-child,
    .flex-right div.inner > :last-child {
      margin-bottom: 0; }
    .flex-left div.inner:last-of-type,
    .flex-right div.inner:last-of-type {
      margin-bottom: 0; }

.flex-left {
  margin-right: -1rem; }
  .flex-left div.outer > div.inner:nth-last-child(2) {
    margin-bottom: 0; }

.flex-right {
  margin-left: -1rem; }

.flex-hidden {
  display: none; }

.blog-page {
  flex-grow: 1;
  min-width: 18rem;
  padding: 1rem;
  width: calc(100% - 42rem); }
  .blog-page .post-toc {
    display: none; }
  .blog-page .post-pagination {
    width: 100%;
    height: 2rem; }
  .blog-page .post-content {
    border: var(--border);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    background-color: var(--background-color);
    color: var(--color); }
    .blog-page .post-content:hover {
      box-shadow: var(--box-shadow-hover); }

.pagination {
  margin: 0;
  padding: 0;
  width: 100%;
  display: flex;
  flex-flow: row nowrap;
  align-items: center;
  justify-content: center;
  font-size: 18px; }
  .pagination div.pagination-box {
    border: var(--border);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    margin: 0 .5rem;
    color: var(--link-color);
    background-color: var(--background-color);
    width: 2rem;
    height: 2rem;
    line-height: 2rem;
    float: left;
    text-align: center;
    vertical-align: middle;
    cursor: default; }
    .pagination div.pagination-box:hover {
      box-shadow: var(--box-shadow-hover); }
    .pagination div.pagination-box:not(.disabled):hover {
      background-color: var(--hover-color);
      cursor: pointer; }
  .pagination div.prev {
    width: 5rem;
    margin-left: 0; }
  .pagination div.next {
    width: 5rem;
    margin-right: 0; }
  .pagination div.pagination-eldivpsis {
    width: 3rem; }
  .pagination div.disabled {
    color: var(--color); }

.posts .post {
  border: var(--border);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  background-color: var(--background-color);
  color: var(--color);
  margin: 1rem 0;
  padding: .7rem 1rem; }
  .posts .post:hover {
    box-shadow: var(--box-shadow-hover); }

.posts :first-child .post {
  margin-top: 0; }

.post-list {
  border: var(--border);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow); }
  .post-list:hover {
    box-shadow: var(--box-shadow-hover); }
  .post-list .post-item {
    padding: .3rem .5rem;
    height: 1.5rem; }
    .post-list .post-item * {
      font-size: 100%;
      vertical-align: bottom; }
    .post-list .post-item:hover a {
      color: var(--link-color);
      text-decoration: underline; }

.post-link {
  color: var(--color); }
  .post-link:hover .post-title a {
    color: var(--link-color);
    text-decoration: underline; }

.post-title {
  margin: 0 0 .5rem 0;
  font-size: 20px; }
  .post-title a {
    color: var(--color); }
  .post-title:hover a {
    color: var(--link-color);
    text-decoration: underline; }

.post-meta {
  color: gray; }
  .post-meta img {
    vertical-align: text-bottom; }

.post-categories {
  font-size: 85%; }
  .post-categories a {
    background-color: var(--category-color);
    border-radius: .2rem;
    padding: .1rem .2rem; }

.post-summary {
  margin-top: .5rem; }

.post-header {
  margin-bottom: 1rem; }

.post-content {
  text-align: justify;
  background-color: white;
  padding: 1rem; }
  .post-content .md__image {
    display: block;
    max-width: 100%;
    margin: auto; }

.post-content > :first-child,
.post-content > :first-child > :first-child,
.post-content > :first-child > :first-child > :first-child,
.markdown-inner > :first-child,
.markdown-inner > :first-child > :first-child,
.markdown-inner > :first-child > :first-child > :first-child {
  margin-top: 0; }

.post-content > :last-child,
.post-content > :last-child > :last-child,
.post-content > :last-child > :last-child > :last-child,
.markdown-inner > :last-child,
.markdown-inner > :last-child > :last-child,
.markdown-inner > :last-child > :last-child > :last-child {
  margin-bottom: 0rem; }

.scroll-to-top {
  border: var(--border);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  display: none;
  position: fixed;
  bottom: 4rem;
  right: 2rem;
  width: 2.5rem;
  height: 2.5rem;
  background-color: white; }
  .scroll-to-top:hover {
    box-shadow: var(--box-shadow-hover); }
  .scroll-to-top img {
    width: 2rem;
    height: 2rem;
    margin: .25rem; }
  .scroll-to-top:hover {
    background-color: #eeeeee; }

@media screen and (max-width: 70rem) {
  .flex-left div.outer > div.inner:nth-last-child(2) {
    margin-bottom: 1rem; }
  .flex-left .flex-hidden {
    display: block; }
  .flex-right {
    display: none; } }

@media screen and (max-width: 48rem) {
  main {
    display: block; }
  .flex-left,
  .flex-right {
    width: 100%;
    margin: 0;
    margin-bottom: -1rem; }
    .flex-left div.outer,
    .flex-right div.outer {
      position: relative;
      width: auto; }
    .flex-left div.inner,
    .flex-right div.inner {
      width: auto; }
  .blog-page {
    width: calc(100% - 2rem); } }

.book-columns {
  margin: .5rem;
  margin-left: -.5rem;
  margin-right: -.5rem; }
  .book-columns div {
    margin: .5rem; }

.book-tabs {
  margin: .5em 0;
  overflow: hidden;
  display: flex;
  flex-wrap: wrap; }
  .book-tabs label {
    display: inline-block;
    padding: .3rem 16px;
    border-top-left-radius: var(--border-radius);
    border-top-right-radius: var(--border-radius);
    cursor: pointer;
    z-index: 999;
    border: 1px solid transparent; }
  .book-tabs .book-tabs-content,
  .book-tabs .book-tabs-pure-content {
    order: 999;
    width: 100%;
    display: none;
    overflow: hidden;
    border-bottom-left-radius: var(--border-radius);
    border-bottom-right-radius: var(--border-radius); }
  .book-tabs .book-tabs-content {
    border: var(--border);
    padding: .5rem; }
  .book-tabs input[type="radio"] {
    display: none; }
    .book-tabs input[type="radio"]:not(:checked) + label {
      color: #95A5A6; }
    .book-tabs input[type="radio"]:checked + label {
      border: var(--border);
      border-bottom: none; }
      .book-tabs input[type="radio"]:checked + label + .book-tabs-content, .book-tabs input[type="radio"]:checked + label + .book-tabs-pure-content {
        display: block; }
    .book-tabs input[type="radio"]:first-of-type:checked + label + .book-tabs-pure-content :first-child {
      border-top-left-radius: 0; }

details {
  border: var(--border);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  margin: .5rem 0;
  padding: .5rem  1rem .5rem  0.75rem; }
  details:hover {
    box-shadow: var(--box-shadow-hover); }
  details summary {
    font-size: 12.8px;
    font-weight: bold; }
    details summary::marker {
      content: '';
      font-size: 0; }
  details ::-webkit-details-marker {
    content: '';
    font-size: 0; }
  details ::-moz-list-bullet {
    content: '';
    font-size: 0; }
  details label {
    font-size: 20px !important;
    margin-left: -5px;
    margin-right: 5px;
    vertical-align: -4.5px; }
  details[open] > summary {
    margin-bottom: 0; }
    details[open] > summary label {
      transform: rotate(90deg); }
  details .markdown-inner {
    margin-top: 1em;
    padding: .5rem 0; }
  details:focus {
    outline: none; }

article h1 {
  font-size: 200%;
  line-height: 110%; }

article h2 {
  font-size: 140%;
  line-height: 120%; }

article h3 {
  font-size: 120%;
  line-height: 120%; }
  article h3 .katex {
    font-size: 100%; }

article h4 {
  font-size: 110%; }

article p {
  line-height: 1.5rem; }

article h1, article h2, article h3, article h4, article h5, article h6, article p {
  margin: .5rem 0; }
  article h1 .anchor, article h2 .anchor, article h3 .anchor, article h4 .anchor, article h5 .anchor, article h6 .anchor, article p .anchor {
    opacity: 0; }
  article h1:hover .anchor, article h1:focus .anchor, article h2:hover .anchor, article h2:focus .anchor, article h3:hover .anchor, article h3:focus .anchor, article h4:hover .anchor, article h4:focus .anchor, article h5:hover .anchor, article h5:focus .anchor, article h6:hover .anchor, article h6:focus .anchor, article p:hover .anchor, article p:focus .anchor {
    opacity: 1; }

article hr {
  border: none;
  border-bottom: 1px solid #ebeced; }

article blockquote {
  border: var(--border);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  border-left: .3rem solid lightgray;
  padding: 0 .5rem; }
  article blockquote:hover {
    box-shadow: var(--box-shadow-hover); }

article pre {
  border: var(--border);
  border-radius: var(--border-radius);
  box-shadow: var(--box-shadow);
  margin: .5rem 0;
  padding: .5rem 1rem;
  overflow-x: auto;
  line-height: 22px; }
  article pre:hover {
    box-shadow: var(--box-shadow-hover); }

article code {
  border: var(--border);
  border-radius: var(--border-radius);
  padding: 1px 2px; }

article pre {
  color: #686868; }
  article pre code {
    border: none;
    padding: 0; }
  article pre * {
    user-select: text;
    -moz-user-select: text;
    -webkit-user-select: text; }

article code:focus {
  outline: none; }

article .md__table {
  margin: -.5rem;
  padding: .5rem;
  overflow: auto; }
  article .md__table::-webkit-scrollbar-track {
    margin: .5rem; }
  article .md__table table {
    border: var(--border);
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
    border-spacing: 0;
    overflow: auto;
    -webkit-overflow-scrolling: touch; }
    article .md__table table:hover {
      box-shadow: var(--box-shadow-hover); }
    article .md__table table th {
      font-weight: normal; }
    article .md__table table td {
      border-top: 1px solid var(--border-color); }
    article .md__table table th, article .md__table table td {
      padding: .3rem 16px;
      white-space: nowrap; }

article .mermaid svg {
  display: block;
  margin: auto;
  zoom: 80%; }
</style>
  
</head>






<body>
<main>
  <div class="flex-left">
    <div class="outer">
      
  <div class="inner avatar">
  <img src="../../../../images/freeze.png" class="avatar" width="96px" height="96px" />
  <h2>NetPipe</h2>
  <div class="data-left">
    <h3>57</h3>
    <span>Posts</span>
  </div>
  <div class="data-right">
    
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
    <h3>17895</h3>
    <span>Words</span>
  </div>
  <div class="social">
    <div class="social-box">
      <img src="../../../../images/search.svg"/>
      <div class="search">
        <input type="text" placeholder="Search" id="search-key" maxlength="64" data-hotkeys="s/" onkeydown="keyup_submit(event);" />
      </div>
    </div>
    <a class="alternate" href="../../../../">
      <div class="social-box">
        <img src="../../../../images/home.svg"/>
        <object><a href="../../../../">Home</a></object>
      </div>
    </a>
    <a class="alternate" href="../../../../post/">
      <div class="social-box">
        <img src="../../../../images/posts.svg"/>
        <object><a href="../../../../post/">Posts</a></object>
      </div>
    </a>
    <a class="alternate" type="application/rss+xml" href="../../../../index.xml">
      <div class="social-box">
        <img src="../../../../images/rss.svg"/>
        <object><a  type="application/rss+xml" href="../../../../index.xml">RSS</a></object>
      </div>
    </a>
  </div>
  <script>
    function keyup_submit(e){ 
    var evt = window.event || e; 
      if (evt.keyCode == 13){
        window.location.href = '/_search?wd=' + document.getElementById("search-key").value;
      }
    }
  </script>
</div>
  <div class="inner categories">
  <h2><img src="../../../../images/categories.svg" />Categories</h2>
  
  <span class="post-categories">
    <a href="../../../../categories/math/">Math</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/acm/">ACM</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/dp/">DP</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/number-theory/">Number Theory</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/graph-theory/">Graph Theory</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/data-structure/">Data Structure</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/string/">String</a>
  </span>
  
  <span class="post-categories">
    <a href="../../../../categories/basic-algorithm/">Basic Algorithm</a>
  </span>
  
</div>

      <div class="flex-hidden">
        
  <div class="inner">
  <h2><img src="../../../../images/notice.svg" />Notice</h2>
  <p>Under Construction ...</p>
</div>
  

<div class="inner">
  <h2><img src="../../../../images/toc.svg">TOC</h2>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a>
      <ul>
        <li><a href="#强连通">强连通</a></li>
        <li><a href="#强连通图">强连通图</a></li>
        <li><a href="#强连通分量">强连通分量</a></li>
      </ul>
    </li>
    <li><a href="#tarjan-算法">Tarjan 算法</a>
      <ul>
        <li><a href="#图的结构">图的结构</a></li>
        <li><a href="#时间戳">时间戳</a></li>
        <li><a href="#追溯值">追溯值</a></li>
        <li><a href="#基本原理">基本原理</a></li>
      </ul>
    </li>
    <li><a href="#kosaraju-算法">Kosaraju 算法</a></li>
    <li><a href="#garbow-算法">Garbow 算法</a></li>
  </ul>
</nav>
</div>



      </div>
    </div>
  </div>

  
<div class="blog-page">
  <article class="post-content">
    
    <div class="post-header">
      <h1>强连通分量</h1>
      <span class="post-meta">
        
          <img src="../../../../images/time.svg"></img>
          Jun 8, 2021
        
      </span>
      <span class="post-categories">
        
          <a href="../../../../categories/acm/">ACM</a>
        
          <a href="../../../../categories/graph-theory/">Graph Theory</a>
        
      </span>
    </div>
    
    <h2 id="简介">简介 <a class="anchor" href="#%e7%ae%80%e4%bb%8b">¶</a></h2><h3 id="强连通">强连通 <a class="anchor" href="#%e5%bc%ba%e8%bf%9e%e9%80%9a">¶</a></h3><p>在有向图 $G$ 中，如果同时存在 $u→v$ 和 $v→u$ 的路径，那么称 $u$ 和 $v$ 强连通.</p>
<p><img class="md__image" src="0.svg" alt=""  /></p>
<h3 id="强连通图">强连通图 <a class="anchor" href="#%e5%bc%ba%e8%bf%9e%e9%80%9a%e5%9b%be">¶</a></h3><p>如果有向图 $G$ 的任意两个节点都强连通，那么称 $G$ 是强连通图.</p>
<p><img class="md__image" src="1.svg" alt=""  /></p>
<h3 id="强连通分量">强连通分量 <a class="anchor" href="#%e5%bc%ba%e8%bf%9e%e9%80%9a%e5%88%86%e9%87%8f">¶</a></h3><p>如果图 $G$ 的子图是强连通图，那么该子图称作 $G$ 的强连通分量.</p>
<p><img class="md__image" src="2.svg" alt=""  /></p>
<p>本章介绍求强连通分量的三种算法.</p>
<h2 id="tarjan-算法">Tarjan 算法 <a class="anchor" href="#tarjan-%e7%ae%97%e6%b3%95">¶</a></h2><h3 id="图的结构">图的结构 <a class="anchor" href="#%e5%9b%be%e7%9a%84%e7%bb%93%e6%9e%84">¶</a></h3><p><code>Tarjan</code> 算法基于对图的 <a href="../../../../docs/NOI/Basics/Search/dfs/">深度优先遍历（<code>DFS</code>）</a>，并且将图近似地看成一棵 <a href="../../../../docs/NOI/Graph/Tree/">树</a>.因此，这棵树中会不可避免地出现一些奇怪的边.</p>
<p><img class="md__image" src="3.svg" alt=""  /></p>
<ul>
<li>
<p><font color=green>前向边</font>：与普通边方向一致，但跨越多个节点.</p>
</li>
<li>
<p><font color=red>返祖边</font>：与普通边方向相反，从子孙指向祖先.</p>
</li>
<li>
<p><font color=#4169e1>横向边</font>：边的两个端点居于树的同一深度.</p>
</li>
</ul>
<h3 id="时间戳">时间戳 <a class="anchor" href="#%e6%97%b6%e9%97%b4%e6%88%b3">¶</a></h3><p><code>DFS</code> 遍历一张图时，按访问顺序给节点打标记.$u$ 是第 $i$ 个被访问的节点，记作 $dfn[u]=i$.这个标记叫做「时间戳」.在图中，时间戳标记在节点的右上方.</p>
<p><img class="md__image" src="4.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center">$5$</td>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$4$</td>
<td style="text-align:center">$6$</td>
</tr>
</tbody>
</table>
<h3 id="追溯值">追溯值 <a class="anchor" href="#%e8%bf%bd%e6%ba%af%e5%80%bc">¶</a></h3><p><code>Tarjan</code> 算法还引入了「追溯值」：$low[u]$，定义为以下节点时间戳的最小值：</p>
<ul>
<li>
<p>以 $u$ 为根的子树中的所有节点.</p>
</li>
<li>
<p>从这棵子树的任意节点出发，经过 $1$ 条前向边、返祖边或横向边，能到达的节点.</p>
</li>
</ul>
<p>以 $low[2]$ 为例，其子树中有 $2,4,5$ 号节点，还可以通过一条返祖边到达 $1$ 号节点.$low[2]$ 为这些节点时间戳的最小值，也就是 $1$.</p>
<p><img class="md__image" src="5.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$5$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$4$</td>
<td style="text-align:center">$6$</td>
</tr>
</tbody>
</table>
<h3 id="基本原理">基本原理 <a class="anchor" href="#%e5%9f%ba%e6%9c%ac%e5%8e%9f%e7%90%86">¶</a></h3><p><code>Tarjan</code> 算法是如何利用 $dfn$ 和 $low$ 来求强连通分量的呢？</p>
<ul>
<li>
<p>首先，强连通分量中必然存在环，也就必然存在返祖边.</p>
</li>
<li>
<p>如果节点 $u$ 满足 $dfn[u]=low[u]$，存在两种情况：</p>
<ul>
<li>
<p>如果 $u$ 没有出边，则 $u$ 独自为一个强连通分量.</p>
</li>
<li>
<p>否则 $u$ 的子树中必有一条返祖边指向 $u$ 本身，此处必存在多节点的强连通分量.</p>
</li>
</ul>
</li>
</ul>
<p>要想具体地确定哪些节点是强连通分量，还得借助 <a href="../../../../docs/NOI/DS/stack/">栈</a>.具体看以下样例.</p>





<div class="book-tabs"><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-0" checked="checked" />
  <label for="tabs-%!s(int=1)-0">1</label>
  <div  class="book-tabs-content" >
    <div class="markdown-inner"><p>$dfn[1]=low[1]=1$.
<img class="md__image" src="6.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
  </div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-1"  />
  <label for="tabs-%!s(int=1)-1">2</label>
  <div  class="book-tabs-content" >
    <div class="markdown-inner"><p>$dfn[2]=low[2]=1$.
<img class="md__image" src="7.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
  </div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-2"  />
  <label for="tabs-%!s(int=1)-2">3</label>
  <div  class="book-tabs-content" >
    <div class="markdown-inner"><p>$dfn[4]=low[4]=3$.节点 $4$ 有一条返祖边指向 $1$，故更新 $low[4]=low[1]=1$.
<img class="md__image" src="8.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center"></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$\textcolor{red}{1}$</td>
<td style="text-align:center"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
  </div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-3"  />
  <label for="tabs-%!s(int=1)-3">4</label>
  <div  class="book-tabs-content" >
    <div class="markdown-inner"><p>回溯至节点 $2$，更新 $low[2]=\min(low[2],low[4])=1$.
<img class="md__image" src="9.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center"></td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$\textcolor{red}{1}$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td></td>
</tr>
</tbody>
</table>
</div>
  </div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-4"  />
  <label for="tabs-%!s(int=1)-4">5</label>
  <div  class="book-tabs-content" >
    <div class="markdown-inner"><p>$dfn[5]=low[5]=4$.节点 $5$ 没有出边和子树，单独一个节点构成强连通分量.移除栈顶的 $5$.
<img class="md__image" src="10.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$\textcolor{red}{4}$</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$\textcolor{red}{4}$</td>
<td></td>
</tr>
</tbody>
</table>
</div>
  </div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-5"  />
  <label for="tabs-%!s(int=1)-5">6</label>
  <div  class="book-tabs-content" >
    <div class="markdown-inner"><p>回溯至节点 $2$，$low[2]=\min(low[2],low[5])=1$.
<img class="md__image" src="11.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$4$</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$4$</td>
<td></td>
</tr>
</tbody>
</table>
</div>
  </div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-6"  />
  <label for="tabs-%!s(int=1)-6">7</label>
  <div  class="book-tabs-content" >
    <div class="markdown-inner"><p>回溯至节点 $1$，$low[1]=\min(low[1],low[2])=1$.此时 $low[1]=dfn[1]$，栈顶的红色部分同属一个强连通分量.将其从栈中删除.
<img class="md__image" src="12.svg" alt=""  /></p>
<table>
<thead>
<tr>
<th style="text-align:center">$u$</th>
<th style="text-align:center">$1$</th>
<th style="text-align:center">$2$</th>
<th style="text-align:center">$3$</th>
<th style="text-align:center">$4$</th>
<th style="text-align:center">$5$</th>
<th style="text-align:center">$6$</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$dfn[u]$</td>
<td style="text-align:center">$\textcolor{red}{1}$</td>
<td style="text-align:center">$2$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$3$</td>
<td style="text-align:center">$4$</td>
<td></td>
</tr>
<tr>
<td style="text-align:center">$low[u]$</td>
<td style="text-align:center">$\textcolor{red}{1}$</td>
<td style="text-align:center">$1$</td>
<td style="text-align:center"></td>
<td style="text-align:center">$1$</td>
<td style="text-align:center">$4$</td>
<td></td>
</tr>
</tbody>
</table>
</div>
  </div><input type="radio" class="toggle" name="tabs-%!s(int=1)" id="tabs-%!s(int=1)-7"  />
  <label for="tabs-%!s(int=1)-7">...</label>
  <div  class="book-tabs-content" >
    <div class="markdown-inner"></div>
  </div></div>

<p>时间复杂度为 $O(n+m)$（$n$ 为点数，$m$ 为边数）.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#95a5a6">// ans: 强连通分量个数
</span><span style="color:#95a5a6"></span><span style="color:#728e00">const</span> <span style="color:#00979d">int</span> <span style="color:#434f54">N</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1e6</span>;
<span style="color:#00979d">int</span> <span style="color:#434f54">dfn</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">low</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">tot</span>, <span style="color:#434f54">ans</span>;
<span style="color:#00979d">int</span> <span style="color:#434f54">in</span>[<span style="color:#434f54">N</span>]; <span style="color:#95a5a6">// u 号节点在第 in[u] 个强连通分量
</span><span style="color:#95a5a6"></span><span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">N</span>]; <span style="color:#95a5a6">// g[u]: u 指向的节点集合
</span><span style="color:#95a5a6"></span><span style="color:#434f54">stack</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">s</span>;

<span style="color:#00979d">void</span> <span style="color:#d35400">tarjan</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) {
    <span style="color:#434f54">dfn</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">++</span> <span style="color:#434f54">tot</span>;
    <span style="color:#434f54">s</span>.<span style="color:#434f54">push</span>(<span style="color:#434f54">u</span>);
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>];
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">dfn</span>[<span style="color:#434f54">v</span>]) {
            <span style="color:#434f54">tarjan</span>(<span style="color:#434f54">v</span>);
            <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">min</span>(<span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>], <span style="color:#434f54">low</span>[<span style="color:#434f54">v</span>]);
        } <span style="color:#728e00">else</span> <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">in</span>[<span style="color:#434f54">u</span>])
            <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">min</span>(<span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>], <span style="color:#434f54">dfn</span>[<span style="color:#434f54">v</span>]);
    }
    <span style="color:#728e00">if</span>(<span style="color:#434f54">dfn</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">==</span> <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>]) {
        <span style="color:#434f54">in</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">++</span> <span style="color:#434f54">ans</span>;
        <span style="color:#728e00">while</span>(<span style="color:#434f54">s</span>.<span style="color:#434f54">top</span>() <span style="color:#728e00">!=</span> <span style="color:#434f54">u</span>) <span style="color:#95a5a6">// 栈顶到 u 这部分的节点在同一个强连通分量
</span><span style="color:#95a5a6"></span>            <span style="color:#434f54">in</span>[<span style="color:#434f54">s</span>.<span style="color:#434f54">top</span>()] <span style="color:#728e00">=</span> <span style="color:#434f54">ans</span>, <span style="color:#434f54">s</span>.<span style="color:#434f54">pop</span>();
        <span style="color:#434f54">s</span>.<span style="color:#434f54">pop</span>();
    }
}
</code></pre></div><h2 id="kosaraju-算法">Kosaraju 算法 <a class="anchor" href="#kosaraju-%e7%ae%97%e6%b3%95">¶</a></h2><p><code>Kosaraju</code> 的核心思想可以总结为两点：</p>
<ul>
<li>
<p>强连通分量反过来还是强连通分量.</p>
</li>
<li>
<p>把强连通分量反一半过来会得到两条共起点、终点的路径.</p>
</li>
</ul>
<p>第一次正向遍历，第二次反向遍历，若出现共起点、终点的两条路径，则此处必有强连通分量.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#728e00">const</span> <span style="color:#00979d">int</span> <span style="color:#434f54">N</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1e6</span>;
<span style="color:#00979d">int</span> <span style="color:#434f54">sccCnt</span>, <span style="color:#434f54">color</span>[<span style="color:#434f54">N</span>], <span style="color:#434f54">vis</span>[<span style="color:#434f54">N</span>];
<span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">N</span>];  <span style="color:#95a5a6">// g[u]:  u 指向的节点集合
</span><span style="color:#95a5a6"></span><span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">g2</span>[<span style="color:#434f54">N</span>]; <span style="color:#95a5a6">// g2[u]: 指向 u 的节点集合（反图）
</span><span style="color:#95a5a6"></span><span style="color:#434f54">vector</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">int</span><span style="color:#728e00">&gt;</span> <span style="color:#434f54">s</span>;

<span style="color:#00979d">void</span> <span style="color:#d35400">dfs1</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) {
    <span style="color:#434f54">vis</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">true</span>;
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>];
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">vis</span>[<span style="color:#434f54">v</span>]) <span style="color:#434f54">dfs1</span>(<span style="color:#434f54">v</span>);
    }
    <span style="color:#434f54">s</span>.<span style="color:#434f54">push_back</span>(<span style="color:#434f54">u</span>);
}

<span style="color:#00979d">void</span> <span style="color:#d35400">dfs2</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) {
    <span style="color:#434f54">color</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">sccCnt</span>;
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;</span> <span style="color:#434f54">g2</span>[<span style="color:#434f54">u</span>].<span style="color:#434f54">size</span>(); <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">g2</span>[<span style="color:#434f54">u</span>][<span style="color:#434f54">i</span>];
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">color</span>[<span style="color:#434f54">v</span>]) <span style="color:#434f54">dfs2</span>(<span style="color:#434f54">v</span>);
    }
}

<span style="color:#00979d">void</span> <span style="color:#d35400">kosaraju</span>() {
    <span style="color:#434f54">sccCnt</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">++</span>)
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">vis</span>[<span style="color:#434f54">i</span>]) <span style="color:#434f54">dfs1</span>(<span style="color:#434f54">i</span>);
    <span style="color:#728e00">for</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&gt;=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">--</span>) {
        <span style="color:#728e00">if</span>(<span style="color:#728e00">!</span><span style="color:#434f54">color</span>[<span style="color:#434f54">s</span>[<span style="color:#434f54">i</span>]]) {
            <span style="color:#728e00">++</span> <span style="color:#434f54">sccCnt</span>;
            <span style="color:#434f54">dfs2</span>(<span style="color:#434f54">s</span>[<span style="color:#434f54">i</span>]);
        }
    }
}
</code></pre></div><h2 id="garbow-算法">Garbow 算法 <a class="anchor" href="#garbow-%e7%ae%97%e6%b3%95">¶</a></h2><blockquote class="book-hint warning">
<p>未完待续 $\cdots \ \cdots$</p>
</blockquote>

<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#00979d">int</span> <span style="color:#d35400">garbow</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">u</span>) {
    <span style="color:#434f54">stack1</span>[<span style="color:#728e00">++</span><span style="color:#434f54">p1</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">u</span>;
    <span style="color:#434f54">stack2</span>[<span style="color:#728e00">++</span><span style="color:#434f54">p2</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">u</span>;
    <span style="color:#434f54">low</span>[<span style="color:#434f54">u</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">++</span><span style="color:#434f54">dfs_clock</span>;
    <span style="color:#728e00">for</span> (<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#434f54">head</span>[<span style="color:#434f54">u</span>]; <span style="color:#434f54">i</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#434f54">e</span>[<span style="color:#434f54">i</span>].<span style="color:#434f54">next</span>) {
        <span style="color:#00979d">int</span> <span style="color:#434f54">v</span> <span style="color:#728e00">=</span> <span style="color:#434f54">e</span>[<span style="color:#434f54">i</span>].<span style="color:#434f54">to</span>;
        <span style="color:#728e00">if</span> (<span style="color:#728e00">!</span><span style="color:#434f54">low</span>[<span style="color:#434f54">v</span>])
            <span style="color:#434f54">garbow</span>(<span style="color:#434f54">v</span>);
        <span style="color:#728e00">else</span> <span style="color:#728e00">if</span> (<span style="color:#728e00">!</span><span style="color:#434f54">sccno</span>[<span style="color:#434f54">v</span>])
            <span style="color:#728e00">while</span> (<span style="color:#434f54">low</span>[<span style="color:#434f54">stack2</span>[<span style="color:#434f54">p2</span>]] <span style="color:#728e00">&gt;</span> <span style="color:#434f54">low</span>[<span style="color:#434f54">v</span>]) <span style="color:#434f54">p2</span><span style="color:#728e00">--</span>;
    }
    <span style="color:#728e00">if</span> (<span style="color:#434f54">stack2</span>[<span style="color:#434f54">p2</span>] <span style="color:#728e00">==</span> <span style="color:#434f54">u</span>) {
        <span style="color:#434f54">p2</span><span style="color:#728e00">--</span>;
        <span style="color:#434f54">scc_cnt</span><span style="color:#728e00">++</span>;
        <span style="color:#728e00">do</span> {
            <span style="color:#434f54">sccno</span>[<span style="color:#434f54">stack1</span>[<span style="color:#434f54">p1</span>]] <span style="color:#728e00">=</span> <span style="color:#434f54">scc_cnt</span>;
        } <span style="color:#728e00">while</span> (<span style="color:#434f54">stack1</span>[<span style="color:#434f54">p1</span><span style="color:#728e00">--</span>] <span style="color:#728e00">!=</span> <span style="color:#434f54">u</span>);
    }
    <span style="color:#728e00">return</span> <span style="color:#8a7b52">0</span>;
}

<span style="color:#00979d">void</span> <span style="color:#d35400">find_scc</span>(<span style="color:#00979d">int</span> <span style="color:#434f54">n</span>) {
    <span style="color:#434f54">dfs_clock</span> <span style="color:#728e00">=</span> <span style="color:#434f54">scc_cnt</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
    <span style="color:#434f54">p1</span> <span style="color:#728e00">=</span> <span style="color:#434f54">p2</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">0</span>;
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">sccno</span>, <span style="color:#8a7b52">0</span>, <span style="color:#728e00">sizeof</span>(<span style="color:#434f54">sccno</span>));
    <span style="color:#434f54">memset</span>(<span style="color:#434f54">low</span>, <span style="color:#8a7b52">0</span>, <span style="color:#728e00">sizeof</span>(<span style="color:#434f54">low</span>));
    <span style="color:#728e00">for</span> (<span style="color:#00979d">int</span> <span style="color:#434f54">i</span> <span style="color:#728e00">=</span> <span style="color:#8a7b52">1</span>; <span style="color:#434f54">i</span> <span style="color:#728e00">&lt;=</span> <span style="color:#434f54">n</span>; <span style="color:#434f54">i</span><span style="color:#728e00">++</span>)
        <span style="color:#728e00">if</span> (<span style="color:#728e00">!</span><span style="color:#434f54">low</span>[<span style="color:#434f54">i</span>]) <span style="color:#434f54">garbow</span>(<span style="color:#434f54">i</span>);
}
</code></pre></div>
  </article>
  <div class="scroll-to-top">
    <img src="../../../../images/scroll-to-top.svg">
  </div>
</div>



  <div class="flex-right">
    <div class="outer">
      
  <div class="inner">
  <h2><img src="../../../../images/notice.svg" />Notice</h2>
  <p>Under Construction ...</p>
</div>
  

<div class="inner">
  <h2><img src="../../../../images/toc.svg">TOC</h2>
  <nav id="TableOfContents">
  <ul>
    <li><a href="#简介">简介</a>
      <ul>
        <li><a href="#强连通">强连通</a></li>
        <li><a href="#强连通图">强连通图</a></li>
        <li><a href="#强连通分量">强连通分量</a></li>
      </ul>
    </li>
    <li><a href="#tarjan-算法">Tarjan 算法</a>
      <ul>
        <li><a href="#图的结构">图的结构</a></li>
        <li><a href="#时间戳">时间戳</a></li>
        <li><a href="#追溯值">追溯值</a></li>
        <li><a href="#基本原理">基本原理</a></li>
      </ul>
    </li>
    <li><a href="#kosaraju-算法">Kosaraju 算法</a></li>
    <li><a href="#garbow-算法">Garbow 算法</a></li>
  </ul>
</nav>
</div>



    </div>
  </div>

  <script src="../../../../js/jquery.min.js"></script>


<script defer>















































</script>



<script>
function judgeScroll() {
  var scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop;
  var scrollToTop = document.getElementsByClassName("scroll-to-top")[0];
  if (scrollTop <= 50) {
    scrollToTop.style.display = 'none';
  } else {
    scrollToTop.style.display = 'block';
  }
}
window.addEventListener("scroll", function(event) {
  judgeScroll();
});
$(".scroll-to-top").click(function() {
  $(window).scrollTop(true);
});
judgeScroll();
</script>





<link rel="stylesheet" href="../../../../katex/katex.min.css">
<script src="../../../../katex/katex.min.js"></script>
<script src="../../../../katex/auto-render.min.js"></script>

<script>
  function renderTex() {
    renderMathInElement(document.body, {
      trust: true,
      delimiters: [
        { left: "$$", right: "$$", display: true },
        { left: "$", right: "$", display: false }
      ],
      macros: {
        
        "\\d": "\\text{d}",
        "\\zh": "\\footnotesize \\ ",
        "\\en": "\\normalsize \\ ",
        "\\su": "\\displaystyle",
        "\\eq": "\\Longleftrightarrow",
        "\\intro": "\\Longrightarrow",
        "\\mathring": "\\overset\{\\normalsizeₒ\}",
        "\\arccot": "\\text\{arccot\} \\, ",
        "\\xor": "\\text\{xor\} \\, ",
        "\\mex": "\\text\{mex\} \\, "
      }
    });
  }  
  document.addEventListener("DOMContentLoaded", function() {
    renderTex();
  });

</script>

<script>
    Array.from(document.getElementsByClassName("language-latex")).forEach(
      (el) => {
        
        el.parentElement.outerHTML = `<div>$$${el.innerText}$$</div>`;
      }
    );
</script>

<script>
  Array.from(document.getElementsByTagName("table")).forEach(
    (el) => {
      el.outerHTML = `<div class="md__table">${el.outerHTML}</div>`;
    }
  );
</script>



<script src="../../../../js/mermaid.min.js"></script>

<script>
  mermaid.initialize({
    
    themeCSS: ".node rect { \
      fill: transparent;    \
      stroke: transparent;  \
    }                       \
    .nodeLabel {            \
      font-size: 24px;      \
    }",
    startOnLoad: true,
    flowchart: {
      curve: 'cardinal'
    },
    securityLevel: 'loose',
  });
</script>

<script>
  Array.from(document.getElementsByClassName("language-mermaid")).forEach(
    (el) => {
      el.parentElement.outerHTML = `<div class="mermaid">${el.innerText}</div>`;
    }
  );
</script>

  
</main>
</body>
</html>